<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>Demo</title>
<link rel="stylesheet" href="index.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
window.AudioContext = window.AudioContext || window.webkitAudioContext;
var timer = 0;
var audioCtx = new AudioContext();
var oscillator = audioCtx.createOscillator();
var gainNode = audioCtx.createGain();
oscillator.connect(gainNode);
oscillator.start(0);  
  
function ChangeBar(b,v){
var curv = Math.pow(1000 * v,2);
var maxv = Math.pow(1000,2);
var v = curv /maxv;
var hz = Math.floor(v * 20000);
$('#input' + b).val(hz);
SetFrequency();
}
  
function SetFrequency(){
var f1 = $('#input1').val();
var f2 = $('#input2').val();
var p = +$('input[name=play]:checked').val();
var type = $('input[name=shape]:checked').val();
if(oscillator.type != type)
	oscillator.type = type;
switch(p){
case 0:
	timer = 0;
	clearInterval(timer);
	gainNode.disconnect();
	break;
case 1:
	timer = 0;
	clearInterval(timer);
	oscillator.frequency.value = f1;
	gainNode.connect(audioCtx.destination);
	break;
case 2:
	timer = 0;
	clearInterval(timer);
	oscillator.frequency.value = f2;
	gainNode.connect(audioCtx.destination);
	break;
case 3:
	var r = Math.random();
	var f = f1 * r + f2 * (1 - r);
	oscillator.frequency.value = f;
	gainNode.connect(audioCtx.destination);
	if(!timer)
		timer = setInterval(function(){
			SetFrequency();
		},1000);
	break;
}
}

function SetVolume(v){
gainNode.gain.value = v;
}

$(document).ready(function(){
ChangeBar(1,0.1);
ChangeBar(2,0.2);
});
</script>
</head>
<body>
<div id="divMain">
<div id="divGitHub">
<div id="GitHub" onclick="location.href='https://github.com/Thibor/RapOscillator'"></div>
</div>
Frequency 1<input id='input1' />Hz
<input type="range" min="0" max="1" value="0.1" step="0.0001" oninput="ChangeBar(1,this.value)">
Frequency 2<input id='input2' />Hz
<input type="range" min="0" max="1" value="0.2" step="0.0001" oninput="ChangeBar(2,this.value)">
Volume
<div id="barVolume"></div>
 <input type="range" min="0" max="1" value="1" step="0.0001" oninput="SetVolume(this.value)">
<fieldset>
<legend>Shape</legend>
<label><input type="radio" name="shape" value="sine" onclick="SetFrequency()" checked />Sine</label>
<label><input type="radio" name="shape" value="triangle" onclick="SetFrequency()" />Triangle</label>
<label><input type="radio" name="shape" value="square" onclick="SetFrequency()" />Square</label>
<label><input type="radio" name="shape" value="sawtooth" onclick="SetFrequency()" />Sawtooth</label>
</fieldset>
<fieldset>
<legend>Play</legend>
<label><input type="radio" name="play" value="0" onclick="SetFrequency()" checked />Off</label>
<label><input type="radio" name="play" value="1" onclick="SetFrequency()" />Frequency 1</label>
<label><input type="radio" name="play" value="2" onclick="SetFrequency()" />Frequency 2</label>
<label><input type="radio" name="play" value="3" onclick="SetFrequency()" />Between</label>
</fieldset>
</div>
</body>
</html>